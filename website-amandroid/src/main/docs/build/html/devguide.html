<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Development Guide &mdash; Sireum Amandroid 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Sireum Amandroid 1.0 documentation" href="index.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="The Amandroid Approach" href="approach.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="approach.html" title="The Amandroid Approach"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Sireum Amandroid 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="development-guide">
<h1>Development Guide<a class="headerlink" href="#development-guide" title="Permalink to this headline">¶</a></h1>
<p>Now we consider that you are interested in developing a new plugin on top of the Amandroid framework to carry out your specific analysis task on an Android app.
This document here is to provide you with a primer: it discusses the main points (with examples) that you need to know in the development process.</p>
<div class="section" id="amandroid-architecture">
<h2>Amandroid Architecture<a class="headerlink" href="#amandroid-architecture" title="Permalink to this headline">¶</a></h2>
<p>Amandroid provides a data flow analysis framework. It makes a variety of functionalities (i.e. APIs) available to the developers
to help them build their own analysis tool. Examples of such functionalities are: (i) Collect necessary information from the input apk file, (ii) Build the Inter-procedural Data Flow Graph (IDFG), and (iii) Build the Data Dependency Graph (DDG).</p>
</div>
<div class="section" id="collect-information-from-apk">
<h2>Collect Information from APK<a class="headerlink" href="#collect-information-from-apk" title="Permalink to this headline">¶</a></h2>
<p>Information collection is necessary for multiple reasons. For instance, it helps us discover certain callback methods (e.g., onClick of a Button).
Moreover, it also helps in identifying special items (e.g. password, Single Sign On options, etc.) present in the apk resource.
Amandroid provides multiple APIs for specialized information collection: (i) Manifest parser, (ii) Layout parser, (iii) ARSC parser, and others.</p>
</div>
<div class="section" id="build-idfg">
<h2>Build IDFG<a class="headerlink" href="#build-idfg" title="Permalink to this headline">¶</a></h2>
<p>IDFG basically consists of interprocedural control flow graph (ICFG) and the reachable facts of each statement (i.e. bytecode instruction).
IDFG also incorporates calling context information upto K.
Your plugin can use IDFG build API and then can access the reachable facts at an arbitrary statement.
For instance, for a network I/O statement in the app your plugin can query (to the IDFG) for the possible URL values, in case that is important for your analysis.</p>
</div>
<div class="section" id="build-ddg">
<h2>Build DDG<a class="headerlink" href="#build-ddg" title="Permalink to this headline">¶</a></h2>
<p>DDG basically represents which statement of IDFG depends on which other statements.
This result is useful in multiple analyses. For instance, this result is fundamental for doing taint analysis.</p>
</div>
<div class="section" id="how-to-design-a-plugin">
<h2>How to Design a Plugin<a class="headerlink" href="#how-to-design-a-plugin" title="Permalink to this headline">¶</a></h2>
<p>It is easy to develop a new plugin tool on top of Amandroid provided your new analysis is related with data flow.
Basically, you can invoke the aforementioned Amandroid functionalities (i.e., APIs) to have the building blocks ready for you.
The new plugin only needs to use these building blocks in implementing your special analysis logic.
We expect that a typical plugin can be written in a few lines of code (hundreds of LOC) only, while the Amandroid framework codebase is huge (consisting of tens of thousands of LOC).</p>
<p>We see two types of data flow analyses you might be interested in. Some details with examples are as follows. Hopefully, they will help you in designing your new plugin.</p>
<div class="section" id="i-analyses-which-require-ddg-results">
<h3>(i) Analyses which require DDG results<a class="headerlink" href="#i-analyses-which-require-ddg-results" title="Permalink to this headline">¶</a></h3>
<p>Examples of this type of analysis are (a) &#8220;data leak detection&#8221;: You need to discover a taint path from a source to a sink.</p>
<p>And (b) &#8220;intent injection detection&#8221;: You need to find a taint path from an incoming intent to a sink.</p>
<p>To perform this type of analysis you would need to use CollectInformation APIs, BuildIDFG APIs, and BuildDDG APIs as discussed above.
Another item you would probably need, which is a Source-Sink manager.</p>
<p>The role of the Source-Sink manager is to identify the source points and sink points in the app relavent to your problem.
In a &#8220;data leak detection&#8221; analysis, any point through which a sensitive information can enter into the app (e.g. the &#8220;password&#8221; field in an app layout)
is considered as a &#8220;source&#8221; while any information exit point (e.g. a network write operation) is a sink.
Amandroid includes a basic Source-Sink manager. You can customize it according to your needs by overriding certain methods.
As an example, for the &#8220;intent injection detection&#8221; plugin, the &#8220;source&#8221; is any incoming &#8220;intent&#8221; to a public Activity,
while the &#8220;sink&#8221; can be the same as that in &#8220;data leak detection&#8221; plugin.</p>
</div>
<div class="section" id="ii-analyses-which-do-not-require-ddg-results">
<h3>(ii) Analyses which do not require DDG results<a class="headerlink" href="#ii-analyses-which-do-not-require-ddg-results" title="Permalink to this headline">¶</a></h3>
<p>An example of this type of analysis is &#8220;crypto-API misuse detection&#8221;. The misuse is detected via inspecting the parameter values of such an API, and matching them with the set of vulnerable signatures. To perform this type of analysis you would need to use CollectInformation APIs, and BuildIDFG APIs.
Note that you will not need a Source-Sink manager in this case.</p>
<p>Finally, one tip in reducing the average analysis time. In reality, it is very useful if you can quickly figure out whether
an app is interesting in the context of your analysis. That can allow you to discard an app after a light analysis
and to run heavy analysis only if the app is interesting. Amandroid provides a hook with the AppInfoCollector,
where you can specify a discard policy (i.e., specify what is not &#8220;interesting&#8221; to you).
As an example, if you are designing a password leak detection plugin, it is natural to discard an app
from which AppInfoCollector was not able to discover any &#8220;password&#8221; field in one of the app layouts.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Development Guide</a><ul>
<li><a class="reference internal" href="#amandroid-architecture">Amandroid Architecture</a></li>
<li><a class="reference internal" href="#collect-information-from-apk">Collect Information from APK</a></li>
<li><a class="reference internal" href="#build-idfg">Build IDFG</a></li>
<li><a class="reference internal" href="#build-ddg">Build DDG</a></li>
<li><a class="reference internal" href="#how-to-design-a-plugin">How to Design a Plugin</a><ul>
<li><a class="reference internal" href="#i-analyses-which-require-ddg-results">(i) Analyses which require DDG results</a></li>
<li><a class="reference internal" href="#ii-analyses-which-do-not-require-ddg-results">(ii) Analyses which do not require DDG results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="approach.html"
                        title="previous chapter">The Amandroid Approach</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.html"
                        title="next chapter">Examples</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="approach.html" title="The Amandroid Approach"
             >previous</a> |</li>
        <li><a href="index.html">Sireum Amandroid 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Fengguo Wei &amp; Sankardas Roy.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>